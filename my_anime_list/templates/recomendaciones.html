<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
	<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
	<link href="https://cdn.jsdelivr.net/npm/daisyui@5/themes.css" rel="stylesheet" type="text/css" />

	<title>Recomendaciones para {{ username }}</title>
</head>

<body class="px-6 py-4">
	<div class="flex justify-between">
		<h1 class="mb-4 text-lg font-bold">Recomendaciones para {{ username }}</h1>
		<div>
			<small>{{ cant_vistos }} vistos, {{ cant_valorados }} valorados - <a href="/reset"
					class="bg-teal-400 text-white font-semibold text-xs px-2 py-1 mt-2 rounded cursor-pointer">reset</a>
			</small>
		</div>
	</div>

  <!-- üîç Filtro de g√©nero -->
  <form method="get" action="/recomendaciones" class="flex gap-4 mb-6 items-center">
    <label for="genero" class="text-sm font-medium text-gray-700">Filtrar por g√©nero:</label>
    <select name="genero" id="genero" class="select select-bordered select-sm w-48">
      <option value="">Todos los g√©neros</option>
      {% for g in generos %}
        <option value="{{ g }}" {% if genero_seleccionado == g %}selected{% endif %}>{{ g }}</option>
      {% endfor %}
    </select>
    <button type="submit" class="btn btn-sm bg-teal-500 hover:bg-teal-600 text-white">Filtrar</button>
  </form>

	<form method="post" action="/recomendaciones">
		<div class="grid grid-cols-3 gap-4">
			{% for rec in animes_recomendados %}
			<div class="card card-side bg-base-100 shadow-sm border bg-base-100">

				<img src="{{ rec.img_src }}" class="w-full max-w-40" />

				<div class="card-body">
					<h2 class="card-title font-semibold link">
						<a href="/recomendaciones/{{rec.anime_id}}">{{ rec.title }}</a>
					</h2>
					<span class="text-sm">
						{{ rec.title }} - {{ rec.genres }} - {{rec.episodes}} - {{ rec.studios }} - {{ rec.year }}
					</span>
					{% if rec.synopsis %}
					<span class="text-xs">{{ rec.synopsis|truncate(400) }}</span>
					{% endif %}

					<div class="card-actions justify-end items-center mt-auto">

						<div class="flex">
							<label for="{{rec.anime_id}}" class="flex-none mr-2">Mi puntuaci√≥n:</label>
							<select name="{{rec.anime_id}}" class="px-4 py-1 text-sm border rounded ">
								<option value="0" selected></option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
								<option value="9">9</option>
								<option value="10">10</option>
							</select>
						</div>

					</div>
				</div>
			</div>
			{% endfor %}
		</div>

		<div class="flex justify-end">
			<input type="submit" class="bg-teal-400 text-white font-semibold px-4 py-1 mt-2 rounded cursor-pointer"
				value="M√°s recomendaciones">
		</div>
	</form>
</body>

</html>